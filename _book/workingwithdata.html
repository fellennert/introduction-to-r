<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Working with data | An(other) introduction to R</title>
  <meta name="description" content="This is a gentle introduction to R and the basic usage of some tidyverse packages (dplyr, tidyr, ggplot2, forcats, stringr) for data manipulation and visualization." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Working with data | An(other) introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a gentle introduction to R and the basic usage of some tidyverse packages (dplyr, tidyr, ggplot2, forcats, stringr) for data manipulation and visualization." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Working with data | An(other) introduction to R" />
  
  <meta name="twitter:description" content="This is a gentle introduction to R and the basic usage of some tidyverse packages (dplyr, tidyr, ggplot2, forcats, stringr) for data manipulation and visualization." />
  

<meta name="author" content="Felix Lennert" />


<meta name="date" content="2021-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intror.html"/>
<link rel="next" href="wrangling.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.4/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prologue</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-outline"><i class="fa fa-check"></i><b>1.1</b> Course outline</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>1.2</b> Why R</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#reproducibility"><i class="fa fa-check"></i><b>1.2.1</b> Reproducibility</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#its-free-and-community-based"><i class="fa fa-check"></i><b>1.2.2</b> It’s free and community-based</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#jobs"><i class="fa fa-check"></i><b>1.2.3</b> Jobs</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#further-links"><i class="fa fa-check"></i><b>1.3</b> Further links</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#last-but-not-least"><i class="fa fa-check"></i><b>1.4</b> Last but not least</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introrstudio.html"><a href="introrstudio.html"><i class="fa fa-check"></i><b>2</b> Getting started with RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introrstudio.html"><a href="introrstudio.html#installing-r"><i class="fa fa-check"></i><b>2.1</b> Installing R</a></li>
<li class="chapter" data-level="2.2" data-path="introrstudio.html"><a href="introrstudio.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="introrstudio.html"><a href="introrstudio.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.3</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="introrstudio.html"><a href="introrstudio.html#some-remarks-on-your-daily-workflow"><i class="fa fa-check"></i><b>2.4</b> Some remarks on your daily workflow</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introrstudio.html"><a href="introrstudio.html#rstudio-projects"><i class="fa fa-check"></i><b>2.4.1</b> RStudio Projects</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introrstudio.html"><a href="introrstudio.html#r-scripts-and-rmarkdown"><i class="fa fa-check"></i><b>2.5</b> R scripts and RMarkdown</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introrstudio.html"><a href="introrstudio.html#r-scripts"><i class="fa fa-check"></i><b>2.5.1</b> R scripts</a></li>
<li class="chapter" data-level="2.5.2" data-path="introrstudio.html"><a href="introrstudio.html#rmarkdown"><i class="fa fa-check"></i><b>2.5.2</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introrstudio.html"><a href="introrstudio.html#further-links-1"><i class="fa fa-check"></i><b>2.6</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intror.html"><a href="intror.html"><i class="fa fa-check"></i><b>3</b> Intro to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intror.html"><a href="intror.html#installing-packages"><i class="fa fa-check"></i><b>3.1</b> Installing packages</a></li>
<li class="chapter" data-level="3.2" data-path="intror.html"><a href="intror.html#basic-arithmetic-operations"><i class="fa fa-check"></i><b>3.2</b> Basic arithmetic operations</a></li>
<li class="chapter" data-level="3.3" data-path="intror.html"><a href="intror.html#vectors"><i class="fa fa-check"></i><b>3.3</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="intror.html"><a href="intror.html#atomic-vectors"><i class="fa fa-check"></i><b>3.3.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="3.3.2" data-path="intror.html"><a href="intror.html#working-with-atomic-vectors"><i class="fa fa-check"></i><b>3.3.2</b> Working with atomic vectors</a></li>
<li class="chapter" data-level="3.3.3" data-path="intror.html"><a href="intror.html#lists"><i class="fa fa-check"></i><b>3.3.3</b> Lists</a></li>
<li class="chapter" data-level="3.3.4" data-path="intror.html"><a href="intror.html#augmented-vectors"><i class="fa fa-check"></i><b>3.3.4</b> Augmented vectors</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="intror.html"><a href="intror.html#further-links-2"><i class="fa fa-check"></i><b>3.4</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workingwithdata.html"><a href="workingwithdata.html"><i class="fa fa-check"></i><b>4</b> Working with data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workingwithdata.html"><a href="workingwithdata.html#reading-in-data-sets"><i class="fa fa-check"></i><b>4.1</b> Reading in data sets</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="workingwithdata.html"><a href="workingwithdata.html#the-working-directory-in-r"><i class="fa fa-check"></i><b>4.1.1</b> The working directory in R</a></li>
<li class="chapter" data-level="4.1.2" data-path="workingwithdata.html"><a href="workingwithdata.html#readrs-general-functions"><i class="fa fa-check"></i><b>4.1.2</b> <code>readr</code>’s general functions…</a></li>
<li class="chapter" data-level="4.1.3" data-path="workingwithdata.html"><a href="workingwithdata.html#and-their-additional-arguments"><i class="fa fa-check"></i><b>4.1.3</b> …and their additional arguments</a></li>
<li class="chapter" data-level="4.1.4" data-path="workingwithdata.html"><a href="workingwithdata.html#column-types"><i class="fa fa-check"></i><b>4.1.4</b> Column types</a></li>
<li class="chapter" data-level="4.1.5" data-path="workingwithdata.html"><a href="workingwithdata.html#rds-and-.rdatafiles"><i class="fa fa-check"></i><b>4.1.5</b> <code>.rds</code> and <code>.RData</code>files</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="workingwithdata.html"><a href="workingwithdata.html#write-data"><i class="fa fa-check"></i><b>4.2</b> Write data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="workingwithdata.html"><a href="workingwithdata.html#write_csv"><i class="fa fa-check"></i><b>4.2.1</b> <code>write_csv()</code></a></li>
<li class="chapter" data-level="4.2.2" data-path="workingwithdata.html"><a href="workingwithdata.html#write_rds"><i class="fa fa-check"></i><b>4.2.2</b> <code>write_rds()</code></a></li>
<li class="chapter" data-level="4.2.3" data-path="workingwithdata.html"><a href="workingwithdata.html#save"><i class="fa fa-check"></i><b>4.2.3</b> <code>save()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="workingwithdata.html"><a href="workingwithdata.html#alternative-ways-to-read-in-and-write-data"><i class="fa fa-check"></i><b>4.3</b> Alternative ways to read in and write data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="workingwithdata.html"><a href="workingwithdata.html#haven"><i class="fa fa-check"></i><b>4.3.1</b> <code>haven</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="workingwithdata.html"><a href="workingwithdata.html#readxl"><i class="fa fa-check"></i><b>4.3.2</b> <code>readxl</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="workingwithdata.html"><a href="workingwithdata.html#vroom"><i class="fa fa-check"></i><b>4.3.3</b> <code>vroom</code></a></li>
<li class="chapter" data-level="4.3.4" data-path="workingwithdata.html"><a href="workingwithdata.html#further-readings"><i class="fa fa-check"></i><b>4.3.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="workingwithdata.html"><a href="workingwithdata.html#tidy-data"><i class="fa fa-check"></i><b>4.4</b> Tidy data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="workingwithdata.html"><a href="workingwithdata.html#in-theory"><i class="fa fa-check"></i><b>4.4.1</b> In theory</a></li>
<li class="chapter" data-level="4.4.2" data-path="workingwithdata.html"><a href="workingwithdata.html#in-practice"><i class="fa fa-check"></i><b>4.4.2</b> In practice</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="workingwithdata.html"><a href="workingwithdata.html#further-links-3"><i class="fa fa-check"></i><b>4.5</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>5</b> Manipulation with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="wrangling.html"><a href="wrangling.html#working-with-the-main-verbs"><i class="fa fa-check"></i><b>5.1</b> Working with the main “verbs”</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="wrangling.html"><a href="wrangling.html#select"><i class="fa fa-check"></i><b>5.1.1</b> <code>select()</code></a></li>
<li class="chapter" data-level="5.1.2" data-path="wrangling.html"><a href="wrangling.html#filter"><i class="fa fa-check"></i><b>5.1.2</b> <code>filter()</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="wrangling.html"><a href="wrangling.html#mutate"><i class="fa fa-check"></i><b>5.1.3</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="wrangling.html"><a href="wrangling.html#summarize-and-group_by"><i class="fa fa-check"></i><b>5.1.4</b> <code>summarize()</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="wrangling.html"><a href="wrangling.html#arrange"><i class="fa fa-check"></i><b>5.1.5</b> <code>arrange()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="wrangling.html"><a href="wrangling.html#introducing-joins"><i class="fa fa-check"></i><b>5.2</b> Introducing <code>joins</code></a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="wrangling.html"><a href="wrangling.html#multiple-types-of-units-are-in-the-same-table"><i class="fa fa-check"></i><b>5.2.1</b> Multiple types of units are in the same table</a></li>
<li class="chapter" data-level="5.2.2" data-path="wrangling.html"><a href="wrangling.html#one-unit-is-in-multiple-tables"><i class="fa fa-check"></i><b>5.2.2</b> One unit is in multiple tables</a></li>
<li class="chapter" data-level="5.2.3" data-path="wrangling.html"><a href="wrangling.html#left_join-and-right_join"><i class="fa fa-check"></i><b>5.2.3</b> <code>left_join()</code> and <code>right_join()</code></a></li>
<li class="chapter" data-level="5.2.4" data-path="wrangling.html"><a href="wrangling.html#inner_join"><i class="fa fa-check"></i><b>5.2.4</b> <code>inner_join()</code></a></li>
<li class="chapter" data-level="5.2.5" data-path="wrangling.html"><a href="wrangling.html#full_join"><i class="fa fa-check"></i><b>5.2.5</b> <code>full_join()</code></a></li>
<li class="chapter" data-level="5.2.6" data-path="wrangling.html"><a href="wrangling.html#semi_join"><i class="fa fa-check"></i><b>5.2.6</b> <code>semi_join()</code></a></li>
<li class="chapter" data-level="5.2.7" data-path="wrangling.html"><a href="wrangling.html#anti_join"><i class="fa fa-check"></i><b>5.2.7</b> <code>anti_join()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="wrangling.html"><a href="wrangling.html#further-links-4"><i class="fa fa-check"></i><b>5.3</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stringregex.html"><a href="stringregex.html"><i class="fa fa-check"></i><b>6</b> String manipulation with <code>stringr</code> and <code>regular expressions</code></a>
<ul>
<li class="chapter" data-level="6.1" data-path="stringregex.html"><a href="stringregex.html#basic-manipulations"><i class="fa fa-check"></i><b>6.1</b> Basic manipulations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="stringregex.html"><a href="stringregex.html#changing-the-case-of-the-words"><i class="fa fa-check"></i><b>6.1.1</b> Changing the case of the words</a></li>
<li class="chapter" data-level="6.1.2" data-path="stringregex.html"><a href="stringregex.html#deternining-a-strings-length"><i class="fa fa-check"></i><b>6.1.2</b> Deternining a string’s length</a></li>
<li class="chapter" data-level="6.1.3" data-path="stringregex.html"><a href="stringregex.html#extracting-particular-characters"><i class="fa fa-check"></i><b>6.1.3</b> Extracting particular characters</a></li>
<li class="chapter" data-level="6.1.4" data-path="stringregex.html"><a href="stringregex.html#concatenating-strings"><i class="fa fa-check"></i><b>6.1.4</b> Concatenating strings</a></li>
<li class="chapter" data-level="6.1.5" data-path="stringregex.html"><a href="stringregex.html#repetition"><i class="fa fa-check"></i><b>6.1.5</b> Repetition</a></li>
<li class="chapter" data-level="6.1.6" data-path="stringregex.html"><a href="stringregex.html#removing-unnecessary-whitespaces"><i class="fa fa-check"></i><b>6.1.6</b> Removing unnecessary whitespaces</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="stringregex.html"><a href="stringregex.html#regular-expressions"><i class="fa fa-check"></i><b>6.2</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="stringregex.html"><a href="stringregex.html#literal-characters"><i class="fa fa-check"></i><b>6.2.1</b> Literal characters</a></li>
<li class="chapter" data-level="6.2.2" data-path="stringregex.html"><a href="stringregex.html#metacharacters"><i class="fa fa-check"></i><b>6.2.2</b> Metacharacters</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="stringregex.html"><a href="stringregex.html#more-advanced-string-manipulation"><i class="fa fa-check"></i><b>6.3</b> More advanced string manipulation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="stringregex.html"><a href="stringregex.html#detect-matches"><i class="fa fa-check"></i><b>6.3.1</b> Detect matches</a></li>
<li class="chapter" data-level="6.3.2" data-path="stringregex.html"><a href="stringregex.html#mutating-strings"><i class="fa fa-check"></i><b>6.3.2</b> Mutating strings</a></li>
<li class="chapter" data-level="6.3.3" data-path="stringregex.html"><a href="stringregex.html#extracting-text"><i class="fa fa-check"></i><b>6.3.3</b> Extracting text</a></li>
<li class="chapter" data-level="6.3.4" data-path="stringregex.html"><a href="stringregex.html#split-vectors"><i class="fa fa-check"></i><b>6.3.4</b> Split vectors</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="stringregex.html"><a href="stringregex.html#further-links-5"><i class="fa fa-check"></i><b>6.4</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="workwithfactors.html"><a href="workwithfactors.html"><i class="fa fa-check"></i><b>7</b> Factors with <code>forcats</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="workwithfactors.html"><a href="workwithfactors.html#creating-a-factor"><i class="fa fa-check"></i><b>7.1</b> Creating a factor</a></li>
<li class="chapter" data-level="7.2" data-path="workwithfactors.html"><a href="workwithfactors.html#some-basic-operations"><i class="fa fa-check"></i><b>7.2</b> Some basic operations</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="workwithfactors.html"><a href="workwithfactors.html#reordering-factors"><i class="fa fa-check"></i><b>7.2.1</b> Reordering factors</a></li>
<li class="chapter" data-level="7.2.2" data-path="workwithfactors.html"><a href="workwithfactors.html#modifying-levels"><i class="fa fa-check"></i><b>7.2.2</b> Modifying levels</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="workwithfactors.html"><a href="workwithfactors.html#further-links-6"><i class="fa fa-check"></i><b>7.3</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>8</b> Describing data sets</a>
<ul>
<li class="chapter" data-level="8.1" data-path="descriptives.html"><a href="descriptives.html#basic-descriptives"><i class="fa fa-check"></i><b>8.1</b> Basic descriptives</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="descriptives.html"><a href="descriptives.html#grouped-descriptives"><i class="fa fa-check"></i><b>8.1.1</b> Grouped descriptives</a></li>
<li class="chapter" data-level="8.1.2" data-path="descriptives.html"><a href="descriptives.html#modifying-the-skim-output"><i class="fa fa-check"></i><b>8.1.2</b> Modifying the <code>skim()</code> output</a></li>
<li class="chapter" data-level="8.1.3" data-path="descriptives.html"><a href="descriptives.html#further-descriptives"><i class="fa fa-check"></i><b>8.1.3</b> Further descriptives</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="descriptives.html"><a href="descriptives.html#communicating-results"><i class="fa fa-check"></i><b>8.2</b> Communicating results</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="descriptives.html"><a href="descriptives.html#tables-with-knitrkable-and-kableextra"><i class="fa fa-check"></i><b>8.2.1</b> Tables with <code>knitr::kable()</code> and <code>kableExtra</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="descriptives.html"><a href="descriptives.html#use-case-reporting-skimr-results"><i class="fa fa-check"></i><b>8.2.2</b> Use case: reporting <code>skimr</code> results</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="descriptives.html"><a href="descriptives.html#further-links-7"><i class="fa fa-check"></i><b>8.3</b> Further links</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>9</b> Visualizations with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="9.1" data-path="visualization.html"><a href="visualization.html#the-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>9.1</b> The “layered grammar of graphics”</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="visualization.html"><a href="visualization.html#the-layers"><i class="fa fa-check"></i><b>9.1.1</b> The layers</a></li>
<li class="chapter" data-level="9.1.2" data-path="visualization.html"><a href="visualization.html#making-them-publishable"><i class="fa fa-check"></i><b>9.1.2</b> Making them “publishable”</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="visualization.html"><a href="visualization.html#further-readings-1"><i class="fa fa-check"></i><b>9.2</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="markdown.html"><a href="markdown.html"><i class="fa fa-check"></i><b>10</b> Writing academic papers with <code>RMarkdown</code></a>
<ul>
<li class="chapter" data-level="10.1" data-path="markdown.html"><a href="markdown.html#introduction"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="markdown.html"><a href="markdown.html#further-resources"><i class="fa fa-check"></i><b>10.2</b> Further resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="functionalprogramming.html"><a href="functionalprogramming.html"><i class="fa fa-check"></i><b>11</b> Functional programming and iterations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="functionalprogramming.html"><a href="functionalprogramming.html#flow-control"><i class="fa fa-check"></i><b>11.1</b> Flow control</a></li>
<li class="chapter" data-level="11.2" data-path="functionalprogramming.html"><a href="functionalprogramming.html#functions"><i class="fa fa-check"></i><b>11.2</b> Functions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="functionalprogramming.html"><a href="functionalprogramming.html#writing-your-own-functions"><i class="fa fa-check"></i><b>11.2.1</b> Writing your own functions</a></li>
<li class="chapter" data-level="11.2.2" data-path="functionalprogramming.html"><a href="functionalprogramming.html#an-example-roulette"><i class="fa fa-check"></i><b>11.2.2</b> An example: Roulette</a></li>
<li class="chapter" data-level="11.2.3" data-path="functionalprogramming.html"><a href="functionalprogramming.html#functional-programming-with-tidyverse-functions"><i class="fa fa-check"></i><b>11.2.3</b> Functional programming with <code>tidyverse</code> functions</a></li>
<li class="chapter" data-level="11.2.4" data-path="functionalprogramming.html"><a href="functionalprogramming.html#further-readings-2"><i class="fa fa-check"></i><b>11.2.4</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="functionalprogramming.html"><a href="functionalprogramming.html#iteration"><i class="fa fa-check"></i><b>11.3</b> Iteration</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="functionalprogramming.html"><a href="functionalprogramming.html#for-loops"><i class="fa fa-check"></i><b>11.3.1</b> <code>for</code> loops</a></li>
<li class="chapter" data-level="11.3.2" data-path="functionalprogramming.html"><a href="functionalprogramming.html#purrrmap"><i class="fa fa-check"></i><b>11.3.2</b> purrr::map()</a></li>
<li class="chapter" data-level="11.3.3" data-path="functionalprogramming.html"><a href="functionalprogramming.html#further-links-8"><i class="fa fa-check"></i><b>11.3.3</b> Further links</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="chapter" data-level="13" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>13</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exercises.html"><a href="exercises.html#chapter-2"><i class="fa fa-check"></i><b>13.1</b> Chapter 2</a></li>
<li class="chapter" data-level="13.2" data-path="exercises.html"><a href="exercises.html#chapter-3"><i class="fa fa-check"></i><b>13.2</b> Chapter 3</a></li>
<li class="chapter" data-level="13.3" data-path="exercises.html"><a href="exercises.html#chapter-4"><i class="fa fa-check"></i><b>13.3</b> Chapter 4</a></li>
<li class="chapter" data-level="13.4" data-path="exercises.html"><a href="exercises.html#chapter-5"><i class="fa fa-check"></i><b>13.4</b> Chapter 5</a></li>
<li class="chapter" data-level="13.5" data-path="exercises.html"><a href="exercises.html#chapter-6"><i class="fa fa-check"></i><b>13.5</b> Chapter 6</a></li>
<li class="chapter" data-level="13.6" data-path="exercises.html"><a href="exercises.html#chapter-7"><i class="fa fa-check"></i><b>13.6</b> Chapter 7</a></li>
<li class="chapter" data-level="13.7" data-path="exercises.html"><a href="exercises.html#chapter-8"><i class="fa fa-check"></i><b>13.7</b> Chapter 8</a></li>
<li class="chapter" data-level="13.8" data-path="exercises.html"><a href="exercises.html#chapter-9"><i class="fa fa-check"></i><b>13.8</b> Chapter 9</a></li>
<li class="chapter" data-level="13.9" data-path="exercises.html"><a href="exercises.html#chapter-10"><i class="fa fa-check"></i><b>13.9</b> Chapter 10</a></li>
<li class="chapter" data-level="13.10" data-path="exercises.html"><a href="exercises.html#chapter-11"><i class="fa fa-check"></i><b>13.10</b> Chapter 11</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="exercises-functions.html"><a href="exercises-functions.html"><i class="fa fa-check"></i><b>14</b> Exercises functions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An(other) introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="workingwithdata" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Working with data</h1>
<p>Today, we will take a first dive into data wrangling. First of all, we need to read in the data into our R session. I will talk about that maybe longer than I should. Thereafter, we need to make sure that the data is in the right format. You probably have not really thought about how a data set is supposed to look like. The concept of tidy data provides you an idea for this.</p>
<div id="reading-in-data-sets" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Reading in data sets</h2>
<p>First, the <code>readr</code> package <span class="citation">(<a href="#ref-hester2018" role="doc-biblioref">Hester et al. 2018</a>)</span> will be introduced. It can be used for the import of the majority of files you will ever want to import and export. If the files become larger, <code>vroom</code> <span class="citation">(<a href="#ref-hester2020" role="doc-biblioref">Hester et al. 2020</a>)</span> is a viable alternative. Beyond that, there exist some more packages for other types such as Excel or Stata files. I will provide you with a basic tutorial on how to deal with them, too.</p>
<p>Some notes on the notation: <code>"file.csv"</code> relates to the file you want to read in – please note that it needs to be provided as a character vector, <code>tibble</code> to the Tibble you want to write.</p>
<div id="the-working-directory-in-r" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> The working directory in R</h3>
<p>As mentioned when introducing RStudio Projects, there are two kinds of file paths you can provide R with: absolute and relative paths.</p>
<p>The absolute path for this script on my machine looks like this: “/Users/felixlennert/Documents/Studium/WHK Regensburg/Kurse/SS 2020/Big Data Analysis using R/big-data-analysis-with-r-2020/scripts/script_pt3.Rmd.”<br />
If you are on a Windows machine and copy file paths: R uses the file path separator <code>\</code> as a so-called escape character – hence, it does not recognize it as a file path separator. You can address this problem by either using double back-slashes <code>\\</code> or using a normal slash, <code>/</code>, instead.</p>
<p>There is always a working directory you are in. You can obtain your working directory using <code>getwd()</code>. Relative paths then just build upon it. If you want to change your working directory, use <code>setwd()</code>.</p>
<p><em>Please note that I included the former two paragraphs just for the record. You should never use absolute paths, except for if you are planning to keep the same machine for the rest of your life and never change any of your file structure. You are not. Hence, please use RStudio Projects.</em><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<p>If you are using RStudio Projects, your working directory defaults to the folder your <code>.Rproj</code> file is stored in.<br />
If you are working in RMarkdown, the working directory is where your RMarkdown document is stored in.</p>
</div>
<div id="readrs-general-functions" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> <code>readr</code>’s general functions…</h3>
<p>In general, importing data with <code>readr</code> is pretty hassle-free: the hardest thing about it is calling the right function. It usually takes care of the rest itself, parsing columns properly, etc. However, sometimes you need to specify additional arguments.</p>
<p>The following unordered list shows the most common <code>read_*()</code> functions. Usually, you can simply provide them a file path and they load in the data and return a Tibble. If your data is in a compressed file with the extension <code>.gz</code>, <code>.bz2</code>, <code>.xz</code>, or <code>.zip</code>, <code>readr</code> will automatically uncompress it. If the file is stored online, you can provide a URL starting with <code>http://</code>, <code>https://</code>, <code>ftp://</code>, or <code>ftps://</code>. <code>readr</code> will automatically take care of the download process.</p>
<ul>
<li><code>read_csv("file.csv")</code> reads comma delimited files<br />
</li>
<li><code>read_csv2("file.csv")</code> reads semi-colon delimited files and treats commas as decimal separator<br />
</li>
<li><code>read_delim("file.txt", delim = "|")</code> reads files which are delimited by whatever delimiter you specify (<code>|</code> in this case)<br />
</li>
<li><code>read_fwf("file.fwf", col_positions = c(1, 3, 5))</code> reads fixed width files. Here, some sort of data on the columns must be provided, e.g., their positions in the file<br />
</li>
<li>If the values are separated by whitespace, you can also use <code>read_tsv("file.tsv")</code> or <code>read_table("file.tsv")</code></li>
</ul>
</div>
<div id="and-their-additional-arguments" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> …and their additional arguments</h3>
<p>Also, all these functions share certain arguments which just need to be included in the call. In the following, I will enumerate the most useful ones.</p>
<ul>
<li>If your file does not have a header (most of the time, column names), provide <code>col_names = FALSE</code>. The resulting Tibble will have <code>X1 … Xn</code> as column names<br />
</li>
<li>If your file does not have column names, but you want the resulting Tibble to have some, you can specify them with <code>col_names = c("a", "b", "c")</code>. It takes a character vector.<br />
</li>
<li>If there are rows you do not want to be considered, you can use <code>skip =</code>. For instance, <code>read_csv("file.csv", skip = 6)</code> reads everything but the first six data rows (the very first row is not taken into consideration as well)<br />
</li>
<li>Sometimes the original creator of your data set might go across missing values differently than you would want it to. <code>na =</code> can be used to specify which values shall be considered missing. If your missings are coded as 99 and 999, for instance, you can address that in the read-in process already by using <code>read_csv("file.csv", na = c("99", "999"))</code>. Please note that it takes a character vector as argument<br />
</li>
<li>In some data sets, the first rows consists of comments that start with particular signs or special characters. Using <code>comment =</code> allows you to skip these lines. For instance, <code>read_csv("file.csv", comment = "#")</code> drops all the rows that beginn with a hash.</li>
</ul>
</div>
<div id="column-types" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Column types</h3>
<p>As you have already learned in the script before, a Tibble consists of multiple vectors of the same length. The vectors can be of different types. When you read in data using <code>readr</code>, it will print out the column types it has guessed. When you read in data, you must ascribe it to an object in your environment. The following code reads in a <code>.csv</code> file with data on the 100 most-played songs on Spotify in 2018 and stores it in the object <code>spotify_top100_2018</code>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="workingwithdata.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb118-2"><a href="workingwithdata.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(readr) --&gt; no need to load readr, it&#39;s part of the core tidyverse</span></span>
<span id="cb118-3"><a href="workingwithdata.html#cb118-3" aria-hidden="true" tabindex="-1"></a>spotify_top100_2018 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/spotify2018.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 100 Columns: 16</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (3): id, name, artists
## dbl (13): danceability, energy, key, loudness, mode, speechiness, acousticne...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>If your data is well-behaved, R will guess the vector types correctly and everything will run smoothly. However, sooner or later you will stumble across a data set which is not well-behaved. This is where knowing how to fine-tune your parsing process up-front will eventually save you a lot of head scratching.</p>
<p>But how does parsing actually look like. Well, <code>readr</code>’s parsing functions take a character vector and return a more specialized vector.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="workingwithdata.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_double</span>(<span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>So far so good. What <code>readr</code>does when it reads in your data sets is that it takes the first 1,000 values of every column and tries to guess the correct data type. This can be emulated using <code>guess_parser()</code> and <code>parse_guess()</code>. Both functions take a character vector as input. The former one returns the guessed type, the latter returns a vector which is parsed to the type it has guessed.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="workingwithdata.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">guess_parser</span>(<span class="st">&quot;2009-04-23&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;date&quot;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="workingwithdata.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">parse_guess</span>(<span class="st">&quot;2009-04-23&quot;</span>))</span></code></pre></div>
<pre><code>##  Date[1:1], format: &quot;2009-04-23&quot;</code></pre>
<p>The heuristic it uses is fairly simple yet robust. However, there are common cases when you might run into problems with different data types. In the following, I will show you the two most common ones. The first one regards numeric data, the second one data on date and time.</p>
<div id="numbers" class="section level4" number="4.1.4.1">
<h4><span class="header-section-number">4.1.4.1</span> Numbers</h4>
<p>Parsing numbers should be straight-forward, right, so what could possibly go wrong?</p>
<p>Well…</p>
<ul>
<li>Decimal points<br />
</li>
<li>Special characters ($, %, §, €)<br />
</li>
<li>So-called grouping characters such as 1,000,000 (USA) or 1.000.000 (Germany) or 1’000’000 (Switzerland)</li>
</ul>
<p>The problem with decimale points (– and commas) can be addresses by specifying a <code>locale</code>. Compare:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="workingwithdata.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_double</span>(<span class="st">&quot;1,3&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 1 parsing failure.
## row col               expected actual
##   1  -- no trailing characters    1,3</code></pre>
<pre><code>## [1] NA
## attr(,&quot;problems&quot;)
## # A tibble: 1 × 4
##     row   col expected               actual
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                  &lt;chr&gt; 
## 1     1    NA no trailing characters 1,3</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="workingwithdata.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_double</span>(<span class="st">&quot;1,3&quot;</span>, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">decimal_mark =</span> <span class="st">&quot;,&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 1.3</code></pre>
<p>The special character problem can be addressed using <code>parse_number</code> instead of <code>parse_double</code>: it will ignore the special characters.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="workingwithdata.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_number</span>(<span class="st">&quot;1.5€&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1.5</code></pre>
<p>The last problem can be addressed using another <code>locale</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="workingwithdata.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_number</span>(<span class="st">&quot;1.300.000&quot;</span>, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">grouping_mark =</span> <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] 1300000</code></pre>
</div>
<div id="date-and-time" class="section level4" number="4.1.4.2">
<h4><span class="header-section-number">4.1.4.2</span> Date and time</h4>
<p>Date vectors in R are numeric vectors indicating how many days have passed since 1970. Date-Time vectors indicate the seconds since 1970-01-01 00:00:00. Time vectors indicate the number of seconds since midnight.</p>
<p>The <code>parse_*()</code> functions expect the vectors to be in a certain format:</p>
<ul>
<li><code>parse_datetime()</code> expects the input to follow the ISO8601 standard. The times components must be ordered from biggest to smallest: year, month, day, hour, minute, second.</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="workingwithdata.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_datetime</span>(<span class="st">&quot;2000-02-29T2000&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2000-02-29 20:00:00 UTC&quot;</code></pre>
<ul>
<li><code>parse_date()</code> wants a four digit year, two digit month, and two digit day. They can be separated by either “-” or “/.”</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="workingwithdata.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_date</span>(<span class="st">&quot;2000-02-29&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2000-02-29&quot;</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="workingwithdata.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_date</span>(<span class="st">&quot;2000/02/29&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2000-02-29&quot;</code></pre>
<p>Do you wonder why I chose 2000-02-29? It’s R’s birthday…</p>
<ul>
<li><code>parse_time()</code> needs at least hours and minutes, seconds are optional. They need to be separated by colons. There is no proper built-in class for time data in Base R. Hence, I will use the <code>hms</code> package here.</li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="workingwithdata.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hms)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;hms&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lubridate&#39;:
## 
##     hms</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="workingwithdata.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_time</span>(<span class="st">&quot;20:15:00&quot;</span>)</span></code></pre></div>
<pre><code>## 20:15:00</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="workingwithdata.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_time</span>(<span class="st">&quot;20:15&quot;</span>) <span class="co"># both works</span></span></code></pre></div>
<pre><code>## 20:15:00</code></pre>
<p>When it comes to dates, you can also build your own format. Just mash together the following pieces:</p>
<ul>
<li>Year: <code>%Y</code> – year in 4 digits; <code>%y</code> – year in two digits following this rule: 00–69 = 2000–2069, 70–99 = 1970–1999<br />
</li>
<li>Month: <code>%m</code> – two digits; <code>%b</code> – abbreviated name (e.g., “Nov”); <code>%B</code> – full name (e.g., “November”)<br />
</li>
<li>Day: <code>%d</code> – two digits<br />
</li>
<li>Time: <code>%H</code> – hour, 0–23; <code>%h</code> – hour, 1–12, must come together with <code>%p</code> – a.m./p.m. indicator; <code>%M</code> – minutes; <code>%S</code> – integer seconds; <code>%Z</code> time zone – <code>America/Chicago</code> for instance<br />
</li>
<li>Non-digits: <code>%.</code> skips one non-digit character; <code>%*</code> skips any number of non-digits</li>
</ul>
<p>You might see that there can emerge problems with this. You might, for example, have something like this:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="workingwithdata.html#cb150-1" aria-hidden="true" tabindex="-1"></a>example_date <span class="ot">&lt;-</span> <span class="st">&quot;29. Februar 2000&quot;</span></span></code></pre></div>
<p>So how can you parse this date with a German month name? Again, you can use <code>locale =</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="workingwithdata.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">date_names_langs</span>() <span class="co"># what could be the proper abbreviation?</span></span></code></pre></div>
<pre><code>##   [1] &quot;af&quot;  &quot;agq&quot; &quot;ak&quot;  &quot;am&quot;  &quot;ar&quot;  &quot;as&quot;  &quot;asa&quot; &quot;az&quot;  &quot;bas&quot; &quot;be&quot;  &quot;bem&quot; &quot;bez&quot;
##  [13] &quot;bg&quot;  &quot;bm&quot;  &quot;bn&quot;  &quot;bo&quot;  &quot;br&quot;  &quot;brx&quot; &quot;bs&quot;  &quot;ca&quot;  &quot;cgg&quot; &quot;chr&quot; &quot;cs&quot;  &quot;cy&quot; 
##  [25] &quot;da&quot;  &quot;dav&quot; &quot;de&quot;  &quot;dje&quot; &quot;dsb&quot; &quot;dua&quot; &quot;dyo&quot; &quot;dz&quot;  &quot;ebu&quot; &quot;ee&quot;  &quot;el&quot;  &quot;en&quot; 
##  [37] &quot;eo&quot;  &quot;es&quot;  &quot;et&quot;  &quot;eu&quot;  &quot;ewo&quot; &quot;fa&quot;  &quot;ff&quot;  &quot;fi&quot;  &quot;fil&quot; &quot;fo&quot;  &quot;fr&quot;  &quot;fur&quot;
##  [49] &quot;fy&quot;  &quot;ga&quot;  &quot;gd&quot;  &quot;gl&quot;  &quot;gsw&quot; &quot;gu&quot;  &quot;guz&quot; &quot;gv&quot;  &quot;ha&quot;  &quot;haw&quot; &quot;he&quot;  &quot;hi&quot; 
##  [61] &quot;hr&quot;  &quot;hsb&quot; &quot;hu&quot;  &quot;hy&quot;  &quot;id&quot;  &quot;ig&quot;  &quot;ii&quot;  &quot;is&quot;  &quot;it&quot;  &quot;ja&quot;  &quot;jgo&quot; &quot;jmc&quot;
##  [73] &quot;ka&quot;  &quot;kab&quot; &quot;kam&quot; &quot;kde&quot; &quot;kea&quot; &quot;khq&quot; &quot;ki&quot;  &quot;kk&quot;  &quot;kkj&quot; &quot;kl&quot;  &quot;kln&quot; &quot;km&quot; 
##  [85] &quot;kn&quot;  &quot;ko&quot;  &quot;kok&quot; &quot;ks&quot;  &quot;ksb&quot; &quot;ksf&quot; &quot;ksh&quot; &quot;kw&quot;  &quot;ky&quot;  &quot;lag&quot; &quot;lb&quot;  &quot;lg&quot; 
##  [97] &quot;lkt&quot; &quot;ln&quot;  &quot;lo&quot;  &quot;lt&quot;  &quot;lu&quot;  &quot;luo&quot; &quot;luy&quot; &quot;lv&quot;  &quot;mas&quot; &quot;mer&quot; &quot;mfe&quot; &quot;mg&quot; 
## [109] &quot;mgh&quot; &quot;mgo&quot; &quot;mk&quot;  &quot;ml&quot;  &quot;mn&quot;  &quot;mr&quot;  &quot;ms&quot;  &quot;mt&quot;  &quot;mua&quot; &quot;my&quot;  &quot;naq&quot; &quot;nb&quot; 
## [121] &quot;nd&quot;  &quot;ne&quot;  &quot;nl&quot;  &quot;nmg&quot; &quot;nn&quot;  &quot;nnh&quot; &quot;nus&quot; &quot;nyn&quot; &quot;om&quot;  &quot;or&quot;  &quot;os&quot;  &quot;pa&quot; 
## [133] &quot;pl&quot;  &quot;ps&quot;  &quot;pt&quot;  &quot;qu&quot;  &quot;rm&quot;  &quot;rn&quot;  &quot;ro&quot;  &quot;rof&quot; &quot;ru&quot;  &quot;rw&quot;  &quot;rwk&quot; &quot;sah&quot;
## [145] &quot;saq&quot; &quot;sbp&quot; &quot;se&quot;  &quot;seh&quot; &quot;ses&quot; &quot;sg&quot;  &quot;shi&quot; &quot;si&quot;  &quot;sk&quot;  &quot;sl&quot;  &quot;smn&quot; &quot;sn&quot; 
## [157] &quot;so&quot;  &quot;sq&quot;  &quot;sr&quot;  &quot;sv&quot;  &quot;sw&quot;  &quot;ta&quot;  &quot;te&quot;  &quot;teo&quot; &quot;th&quot;  &quot;ti&quot;  &quot;to&quot;  &quot;tr&quot; 
## [169] &quot;twq&quot; &quot;tzm&quot; &quot;ug&quot;  &quot;uk&quot;  &quot;ur&quot;  &quot;uz&quot;  &quot;vai&quot; &quot;vi&quot;  &quot;vun&quot; &quot;wae&quot; &quot;xog&quot; &quot;yav&quot;
## [181] &quot;yi&quot;  &quot;yo&quot;  &quot;zgh&quot; &quot;zh&quot;  &quot;zu&quot;</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="workingwithdata.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_date</span>(example_date, <span class="at">format =</span> <span class="st">&quot;%d%. %B %Y&quot;</span>, <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">date_names =</span> <span class="st">&quot;de&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2000-02-29&quot;</code></pre>
<p>Now you know how to parse number and date vectors yourself. This is nice, but normally you do not want to read in data, put it into character vectors and then parse it to the right data format. You want to read in a data set and get a Tibble whose columns consist of data which have been parsed to the right type already.</p>
</div>
<div id="parsing-entire-files" class="section level4" number="4.1.4.3">
<h4><span class="header-section-number">4.1.4.3</span> Parsing entire files</h4>
<p>As mentioned earlier, the <code>read_*</code> functions take the first 1000 rows and then guess the columns format. I emulated this using the <code>guess_parser()</code> function.</p>
<p>If <code>readr</code> finds values in a column that do not match the type of the column which it has guessed in first place, or entirely fails to parse a column (e.g., because it only consists of <code>NAs</code>), it returns parsing failures. They can be obtained using <code>problems()</code>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="workingwithdata.html#cb155-1" aria-hidden="true" tabindex="-1"></a>challenge <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>))</span></code></pre></div>
<pre><code>## Rows: 2000 Columns: 2</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl  (1): x
## date (1): y</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="workingwithdata.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(challenge)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##       x y     
##   &lt;dbl&gt; &lt;date&gt;
## 1   404 NA    
## 2  4172 NA    
## 3  3004 NA    
## 4   787 NA    
## 5    37 NA    
## 6  2332 NA</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="workingwithdata.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">problems</span>(challenge)</span></code></pre></div>
<pre><code>## # A tibble: 0 × 5
## # … with 5 variables: row &lt;int&gt;, col &lt;int&gt;, expected &lt;chr&gt;, actual &lt;chr&gt;,
## #   file &lt;chr&gt;</code></pre>
<p>When looking at the parsing failures here, what catches the eye is that the first 1000 values of <code>challenge$y</code> seem to be NA. Because <code>readr</code> only takes the first 1000 rows into account, it parses <code>challenge$y</code> as <code>logical</code>. However, it should be considered a <code>date</code> column. You can specify this using <code>col_types =</code>:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="workingwithdata.html#cb163-1" aria-hidden="true" tabindex="-1"></a>challenge_w_date <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>),</span>
<span id="cb163-2"><a href="workingwithdata.html#cb163-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb163-3"><a href="workingwithdata.html#cb163-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">x =</span> <span class="fu">col_number</span>(),</span>
<span id="cb163-4"><a href="workingwithdata.html#cb163-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> <span class="fu">col_date</span>()</span>
<span id="cb163-5"><a href="workingwithdata.html#cb163-5" aria-hidden="true" tabindex="-1"></a>                             ))</span></code></pre></div>
<p>In general, every <code>parse_*</code> function has its <code>col_*</code> counterpart.</p>
<p>If you want to read in data and change the column specifications, there is a little shortcut:</p>
<p>First, read in your data set:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="workingwithdata.html#cb164-1" aria-hidden="true" tabindex="-1"></a>challenge <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>))</span></code></pre></div>
<pre><code>## Rows: 2000 Columns: 2</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl  (1): x
## date (1): y</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Second, you can copy the column specification from the output to your clipboard:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="workingwithdata.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This part: </span></span>
<span id="cb168-2"><a href="workingwithdata.html#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cols(</span></span>
<span id="cb168-3"><a href="workingwithdata.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  x = col_double(),</span></span>
<span id="cb168-4"><a href="workingwithdata.html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  y = col_logical()</span></span>
<span id="cb168-5"><a href="workingwithdata.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span></code></pre></div>
<p>Third, provide it your <code>read_csv()</code> call as a <code>col_types =</code> argument (by simply pasting it):</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="workingwithdata.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#challenge &lt;- read_csv(readr_example(&quot;challenge.csv&quot;),</span></span>
<span id="cb169-2"><a href="workingwithdata.html#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                     col_types = cols(</span></span>
<span id="cb169-3"><a href="workingwithdata.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                       x = col_double(),</span></span>
<span id="cb169-4"><a href="workingwithdata.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  needs to be modified --&gt; y = col_logical()</span></span>
<span id="cb169-5"><a href="workingwithdata.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                            ))</span></span></code></pre></div>
<p>Fourth, modify the argument:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="workingwithdata.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#challenge_w_date &lt;- read_csv(readr_example(&quot;challenge.csv&quot;),</span></span>
<span id="cb170-2"><a href="workingwithdata.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                             col_types = cols(</span></span>
<span id="cb170-3"><a href="workingwithdata.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                               x = col_number(),</span></span>
<span id="cb170-4"><a href="workingwithdata.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  modified --&gt;                 y = col_date()</span></span>
<span id="cb170-5"><a href="workingwithdata.html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                            ))</span></span></code></pre></div>
<p>Fifth, read it in:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="workingwithdata.html#cb171-1" aria-hidden="true" tabindex="-1"></a>challenge_w_date <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>),</span>
<span id="cb171-2"><a href="workingwithdata.html#cb171-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb171-3"><a href="workingwithdata.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="fu">col_number</span>(),</span>
<span id="cb171-4"><a href="workingwithdata.html#cb171-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="fu">col_date</span>()</span>
<span id="cb171-5"><a href="workingwithdata.html#cb171-5" aria-hidden="true" tabindex="-1"></a>                      ))</span></code></pre></div>
</div>
</div>
<div id="rds-and-.rdatafiles" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> <code>.rds</code> and <code>.RData</code>files</h3>
<p><code>.rds</code> files can be used to store singular R-specific objects (such as lists), <code>.RData</code> files can be used to store multiple R-specific objects. The former can be read in using <code>read_rds("file.rds")</code>, the latter with <code>load("file.RData")</code>. More on <code>read_rds()</code> <a href="https://readr.tidyverse.org/reference/read_rds.html">here</a> and <code>.RData</code> <a href="http://www.sthda.com/english/wiki/saving-data-into-r-data-format-rds-and-rdata">here</a></p>
</div>
</div>
<div id="write-data" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Write data</h2>
<div id="write_csv" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> <code>write_csv()</code></h3>
<p>Writing data is fairly straight-forward. Most of the times, you will work with plain Tibbles which consist of different kinds of vectors except for lists. If you want to store them, I recommend you to simply use <code>write_csv(tibble, path = "file.csv")</code>. If you plan on working on the <code>.csv</code> file in Excel, use <code>write_excel_csv(tibble, path = "file.csv")</code></p>
</div>
<div id="write_rds" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> <code>write_rds()</code></h3>
<p>Sometimes, however, it might be impossible to create a <code>.csv</code> file of your data – e.g., if you want to store a list. This is what you can use <code>write_rds(r_specific_object, path = "file.rds")</code> for.</p>
</div>
<div id="save" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> <code>save()</code></h3>
<p>Akin to <code>.rds</code> files are <code>.RData</code> files. They can contain multiple objects and be written using <code>save(r_specific_object_1, r_specific_object_2, r_specific_object_n, file = "file.RData")</code>. You can save your entire workspace as well by calling <code>save.image(file = "file.RData")</code>.</p>
</div>
</div>
<div id="alternative-ways-to-read-in-and-write-data" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Alternative ways to read in and write data</h2>
<p>There do also other packages exist for different data types. I will explain the ones which might be of particular use for you and their main-functions only briefly.</p>
<div id="haven" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> <code>haven</code></h3>
<p>You can use <code>haven</code> <span class="citation">(<a href="#ref-wickham2020c" role="doc-biblioref">Wickham and Miller 2020</a>)</span> for reading and writing SAS (suffixes <code>.sas7bdat</code>, <code>.sas7bcat</code>, and <code>.xpt</code>), SPSS (suffixes <code>.sav</code> and <code>.por</code>), and STATA (suffix <code>.dta</code>) files.</p>
<p>The functions then are:</p>
<ul>
<li><code>read_sas("file.sas7bdate"</code> and <code>write_sas(tibble, "file.sas7bdat")</code> for both <code>.sas7bdat</code> and <code>.sas7bcat</code> files. <code>read_xpt("file.xpt")</code> reads <code>.xpt</code> files<br />
</li>
<li><code>read_sav("file.sav")</code> and <code>read_por("file.por")</code> for <code>.sav</code> and <code>.por</code> files. <code>write_sav(tibble, "file.sav"</code> writes a the Tibble <code>tibble</code> to the file <code>file.sav</code><br />
</li>
<li><code>read_dta("file.dta")</code> and <code>write_dta(tibble, "file.dta")</code> read and write <code>.dta</code> files</li>
</ul>
<p>The additional arguments can be found in the <a href="https://cran.r-project.org/web/packages/haven/vignettes/semantics.html">vignette</a>.</p>
</div>
<div id="readxl" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> <code>readxl</code></h3>
<p><code>readxl</code> <span class="citation">(<a href="#ref-wickham2019e" role="doc-biblioref">Wickham, Bryan, et al. 2019</a>)</span> can be used to read Excel files. <code>read_excel("file.xls")</code> works for both <code>.xls</code> and <code>.xlsx</code> files alike. It guesses the data type from the suffix. Excel files often consist of multiple sheets. <code>excel_sheets("file.xlsx")</code> returns the name of the singular sheets. When dealing with an Excel file that contains multiple sheets, you need to specify the sheet you are after in the <code>read_excel()</code> function: <code>read_excel("file.xlsx", sheet = "sheet_1")</code>. Please note that it only takes one sheet at a time.</p>
<p>More on the <code>readxl</code> package can be found <a href="https://readxl.tidyverse.org">here</a>.</p>
</div>
<div id="vroom" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> <code>vroom</code></h3>
<p><code>vroom</code> has been introduced recently. It claims to be able to read in delimited files with up to 1.4 GB/s. Regarding its arguments, <code>vroom</code> works in the same way as the <code>read_*()</code> functions from the <code>readr</code> package. I would recommend you to use <code>vroom</code> as soon as your dataset’s size exceeds ~100 MB.</p>
<p>More on <code>vroom</code> <a href="https://vroom.r-lib.org/reference/vroom.html">here</a> and <a href="https://dcl-wrangle.stanford.edu/read-write.html">here</a>.</p>
</div>
<div id="further-readings" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Further readings</h3>
<ul>
<li><a href="https://support.rstudio.com/hc/en-us/articles/200711843-Working-Directories-and-Workspaces">Information on working directories</a><br />
</li>
<li>Websites of the singular packages: <a href="https://readr.tidyverse.org">readr</a>, <a href="https://haven.tidyverse.org">haven</a>, <a href="https://readxl.tidyverse.org">readxl</a>, <a href="https://vroom.r-lib.org">vroom</a><br />
</li>
<li><code>readr</code> <a href="https://rawgit.com/rstudio/cheatsheets/master/data-import.pdf">Cheatsheet</a><br />
</li>
<li>Chapter in R for Data Science <span class="citation">(<a href="#ref-wickham2016a" role="doc-biblioref">Wickham and Grolemund 2016</a>)</span> regarding <a href="https://r4ds.had.co.nz/data-import.html">data import</a></li>
</ul>
</div>
</div>
<div id="tidy-data" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Tidy data</h2>
<p>Before you learn how to tidy and wrangle data, you need to know how you want your dataset to actually look like, i.e., what the desired outcome of the entire process of tidying your dataset is. The <code>tidyverse</code> is a collection of packages which share an underlying philosophy: they are tidy. This means, that they (preferably) take tidy data as inputs and output tidy data. In the following, I will, first, introduce you to the concept of tidy data as developed by Hadley Wickham <span class="citation">(<a href="#ref-wickham2014" role="doc-biblioref">Wickham 2014</a>)</span>. Second, <code>tidyr</code> is introduced <span class="citation">(<a href="#ref-wickham2020b" role="doc-biblioref">Wickham 2020b</a>)</span>. Its goal is to provide you with functions that facilitate tidying datasets. Beyond, I will provide you some examples of how to create tibbles using functions from the <code>tibble</code> package <span class="citation">(<a href="#ref-muller2020" role="doc-biblioref">Müller, Wickham, and François 2020</a>)</span>. Moreover, the pipe from the <code>magrittr</code> package is introduced.</p>
<p>Please note that tidying and cleaning data are not equivalent: I refer to tidying data as to bringing data in a tidy format. Cleaning data, however, can encompass way more than this: parsing columns in the right format (using <code>readr</code>, for instance), imputation of missing values, address the problem of typos, etc.</p>
<div id="in-theory" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> In theory</h3>
<p>Datasets can be structured in many ways. To make them tidy, they must be organized in the following way (this is taken from the R for Data Science book <span class="citation">(<a href="#ref-wickham2016a" role="doc-biblioref">Wickham and Grolemund 2016</a>)</span>):</p>
<ol style="list-style-type: decimal">
<li>Each variable must have its own column.<br />
</li>
<li>Each observation must have its own row.<br />
</li>
<li>Each value must have its own cell.</li>
</ol>
<p>They can even be boiled further down:</p>
<ol style="list-style-type: decimal">
<li>Put each dataset in a tibble.</li>
<li>Put each variable in a column.</li>
</ol>
<p>This can also be visually depicted:</p>
<div class="figure">
<img src="figures/tidy_data.png" alt="" />
<p class="caption">The three rules that make a dataset tidy (taken from Wickham and Grolemund 2016: 149)</p>
</div>
<p>This way of storing data has two big advantages:</p>
<ul>
<li>you can easily access, and hence manipulate, variables as vectors<br />
</li>
<li>if you perform vectorized operations on the tibble, cases are preserved.</li>
</ul>
</div>
<div id="in-practice" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> In practice</h3>
<p>So what are the most common problems with data sets? The following list is taken from the <code>tidyr</code> vignette<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>:</p>
<ul>
<li>Column headers are values, not variable names.<br />
</li>
<li>Variables are stored in both rows and columns.<br />
</li>
<li>Multiple variables are stored in one column.<br />
</li>
<li>Multiple types of observational units are stored in the same table.<br />
</li>
<li>A single observational unit is stored in multiple tables.</li>
</ul>
<p>I will go across the former three types of problems, because the latter two require some more advanced data wrangling techniques you haven’t learned yet (i.e., functions from the <code>dplyr</code> package: <code>select()</code>, <code>mutate()</code>, <code>left_join()</code>, among others).</p>
<p>In the following, I will provide you with examples on how this might look like and how you can address the respective problem using functions from the <code>tidyr</code> package. This will serve as an introduction to the two most important functions of the <code>tidyr</code> package: <code>pivot_longer()</code> and its counterpart <code>pivot_wider()</code>. Beyond that, <code>separate()</code> will be introduced as well. At the beginning of every part, I will build the tibble using functions from the <code>tibble</code> package. This should suffice as a quick refresher for and introduction to creating tibbles.</p>
<p><code>tidyr</code> has some more functions in stock. They do not necessarily relate to transforming messy data sets into tidy ones, but also serve you well for some general cleaning tasks. They will be introduced, too.</p>
<div id="column-headers-are-values" class="section level4" number="4.4.2.1">
<h4><span class="header-section-number">4.4.2.1</span> Column headers are values</h4>
<p>A data set of this form would look like this:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="workingwithdata.html#cb172-1" aria-hidden="true" tabindex="-1"></a>tibble_value_headers <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb172-2"><a href="workingwithdata.html#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">manufacturer =</span> <span class="fu">c</span>(<span class="st">&quot;Audi&quot;</span>, <span class="st">&quot;BMW&quot;</span>, <span class="st">&quot;Mercedes&quot;</span>, <span class="st">&quot;Opel&quot;</span>, <span class="st">&quot;VW&quot;</span>),</span>
<span id="cb172-3"><a href="workingwithdata.html#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">3 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-4"><a href="workingwithdata.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">4 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">50</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-5"><a href="workingwithdata.html#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">5 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-6"><a href="workingwithdata.html#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">6 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">50</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-7"><a href="workingwithdata.html#cb172-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">8 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-8"><a href="workingwithdata.html#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">10 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">10</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-9"><a href="workingwithdata.html#cb172-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">12 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb172-10"><a href="workingwithdata.html#cb172-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">16 cyl</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb172-11"><a href="workingwithdata.html#cb172-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb172-12"><a href="workingwithdata.html#cb172-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-13"><a href="workingwithdata.html#cb172-13" aria-hidden="true" tabindex="-1"></a>tibble_value_headers</span></code></pre></div>
<pre><code>## # A tibble: 5 × 9
##   manufacturer `3 cyl` `4 cyl` `5 cyl` `6 cyl` `8 cyl` `10 cyl` `12 cyl`
##   &lt;chr&gt;          &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
## 1 Audi              15      62       6      48      26        3        5
## 2 BMW               14      58       5      47      27        5       11
## 3 Mercedes          19      61       4      33      35        8        3
## 4 Opel              12      80       1      48      31        3       18
## 5 VW                15      58       9      34      20        1       19
## # … with 1 more variable: 16 cyl &lt;dbl&gt;</code></pre>
<p>You can create a tibble <em>by column</em> using the <code>tibble</code> function. Column names need to be specified and linked to vectors of either the same length or length one.</p>
<p>This data set basically consists of three variables: <code>German car manufacturer</code>, <code>number of cylinders</code>, and <code>frequency</code>. To make the data set tidy, it has to consist of three columns depicting the three respective variables. This operation is called pivoting the non-variable columns into two-column key-value pairs. As the data set will thereafter contain fewer columns and more rows than before, it will have become longer (or taller). Hence, the tidyr function is called <code>pivot_longer()</code>.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="workingwithdata.html#cb174-1" aria-hidden="true" tabindex="-1"></a>ger_car_manufacturer_longer <span class="ot">&lt;-</span> tibble_value_headers <span class="sc">%&gt;%</span> </span>
<span id="cb174-2"><a href="workingwithdata.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>manufacturer, <span class="at">names_to =</span> <span class="st">&quot;cylinders&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;frequency&quot;</span>)</span>
<span id="cb174-3"><a href="workingwithdata.html#cb174-3" aria-hidden="true" tabindex="-1"></a>ger_car_manufacturer_longer</span></code></pre></div>
<pre><code>## # A tibble: 40 × 3
##    manufacturer cylinders frequency
##    &lt;chr&gt;        &lt;chr&gt;         &lt;dbl&gt;
##  1 Audi         3 cyl            15
##  2 Audi         4 cyl            62
##  3 Audi         5 cyl             6
##  4 Audi         6 cyl            48
##  5 Audi         8 cyl            26
##  6 Audi         10 cyl            3
##  7 Audi         12 cyl            5
##  8 Audi         16 cyl            0
##  9 BMW          3 cyl            14
## 10 BMW          4 cyl            58
## # … with 30 more rows</code></pre>
<p>In the function call, you need to specify the following: if you were not to use the pipe, the first argument would be the tibble you are manipulating. Then, you look at the column you want to <strong>keep</strong>. Here, it is the car manufacturer. This means that all columns but <code>manufacturer</code> will be crammed into two new ones: one will contain the columns’ names, the other one their values. How are those new column supposed to be named? That can be specified in the <code>names_to =</code> and <code>values_to =</code>arguments. Please note that you need to provide them a character vector, hence, surround your parameters with quotation marks. As a rule of thumb for all <code>tidyverse</code> packages: If it is a new column name you provide, surround it with quotation marks. If it is one that already exists – like, here, manufacturer, then you do not need the quotation marks.</p>
</div>
<div id="variables-in-both-rows-and-columns" class="section level4" number="4.4.2.2">
<h4><span class="header-section-number">4.4.2.2</span> Variables in both rows and columns</h4>
<p>You have this data set:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="workingwithdata.html#cb176-1" aria-hidden="true" tabindex="-1"></a>car_models_fuel <span class="ot">&lt;-</span> <span class="fu">tribble</span>(<span class="sc">~</span>manufacturer, <span class="sc">~</span>model, <span class="sc">~</span>cylinders, <span class="sc">~</span>fuel_consumption_type, <span class="sc">~</span>fuel_consumption_per_100km,</span>
<span id="cb176-2"><a href="workingwithdata.html#cb176-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;VW&quot;</span>, <span class="st">&quot;Golf&quot;</span>, <span class="dv">4</span>, <span class="st">&quot;urban&quot;</span>, <span class="fl">5.2</span>,</span>
<span id="cb176-3"><a href="workingwithdata.html#cb176-3" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;VW&quot;</span>, <span class="st">&quot;Golf&quot;</span>, <span class="dv">4</span>, <span class="st">&quot;extra urban&quot;</span>, <span class="fl">4.5</span>,</span>
<span id="cb176-4"><a href="workingwithdata.html#cb176-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Opel&quot;</span>, <span class="st">&quot;Adam&quot;</span>, <span class="dv">4</span>, <span class="st">&quot;urban&quot;</span>, <span class="fl">4.9</span>,</span>
<span id="cb176-5"><a href="workingwithdata.html#cb176-5" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Opel&quot;</span>, <span class="st">&quot;Adam&quot;</span>, <span class="dv">4</span>, <span class="st">&quot;extra urban&quot;</span>, <span class="fl">4.1</span>)</span>
<span id="cb176-6"><a href="workingwithdata.html#cb176-6" aria-hidden="true" tabindex="-1"></a>car_models_fuel</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##   manufacturer model cylinders fuel_consumption_type fuel_consumption_per_100km
##   &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;                                      &lt;dbl&gt;
## 1 VW           Golf          4 urban                                        5.2
## 2 VW           Golf          4 extra urban                                  4.5
## 3 Opel         Adam          4 urban                                        4.9
## 4 Opel         Adam          4 extra urban                                  4.1</code></pre>
<p>It was created using the <code>tribble</code> function: tibbles can also be created <em>by row</em>. First, the column names need to be specified by putting a tilde (<code>~</code>) in front of them. Then, you can put in values separated by commas. Please note that the number of values needs to be a multiple of the number of columns.</p>
<p>In this data set, there are basically five variables: manufacturer, model, cylinders, urban fuel consumption, and extra urban fuel consumption. However, the column <code>fuel_consumption_type</code> does not store a variable but the names of two variables. Hence, you need to fix this to make the data set tidy. Because this encompasses reducing the number of rows, the data set becomes wider. The function to achieve this is therefore called <code>pivot_wider()</code> and the inverse of <code>pivot_longer()</code>.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="workingwithdata.html#cb178-1" aria-hidden="true" tabindex="-1"></a>car_models_fuel_tidy <span class="ot">&lt;-</span> car_models_fuel <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="workingwithdata.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> fuel_consumption_type, <span class="at">values_from =</span> fuel_consumption_per_100km)</span>
<span id="cb178-3"><a href="workingwithdata.html#cb178-3" aria-hidden="true" tabindex="-1"></a>car_models_fuel_tidy</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   manufacturer model cylinders urban `extra urban`
##   &lt;chr&gt;        &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
## 1 VW           Golf          4   5.2           4.5
## 2 Opel         Adam          4   4.9           4.1</code></pre>
<p>Here, you only need to specify the columns you fetch the names and values from. As they both do already exist, you do not need to wrap them in quotation marks.</p>
</div>
<div id="multiple-variables-in-one-column" class="section level4" number="4.4.2.3">
<h4><span class="header-section-number">4.4.2.3</span> Multiple variables in one column</h4>
<p>Now, however, there is a problem with the cylinders: their number should be depicted in a numeric vector. We could achieve this by either parsing it to a numeric vector:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="workingwithdata.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_number</span>(ger_car_manufacturer_longer<span class="sc">$</span>cylinders)</span></code></pre></div>
<pre><code>##  [1]  3  4  5  6  8 10 12 16  3  4  5  6  8 10 12 16  3  4  5  6  8 10 12 16  3
## [26]  4  5  6  8 10 12 16  3  4  5  6  8 10 12 16</code></pre>
<p>On the other hand, we can also use a handy function from <code>tidyr</code> called <code>separate()</code> and afterwards drop the unnecessary column:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="workingwithdata.html#cb182-1" aria-hidden="true" tabindex="-1"></a>ger_car_manufacturer_longer_sep_cyl <span class="ot">&lt;-</span> ger_car_manufacturer_longer <span class="sc">%&gt;%</span> <span class="co"># first, take the tibble</span></span>
<span id="cb182-2"><a href="workingwithdata.html#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(cylinders, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cylinders&quot;</span>, <span class="st">&quot;drop_it&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># and then split the column &quot;cylinders&quot; into two</span></span>
<span id="cb182-3"><a href="workingwithdata.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>drop_it) <span class="co"># you will learn about this in the lesson on dplyr  # and then drop one column from the tibble</span></span></code></pre></div>
<p>If there are two (or actually more) relevant values in one column, you can simply let out the dropping process and easily split them into multiple columns. By default, the <code>sep =</code> argument divides the content by all non-alphanumeric characters (every character that is not a letter, number, or space) it contains.</p>
<p>Please note that the new column is still in character format. We can change this using <code>as.numeric()</code>:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="workingwithdata.html#cb183-1" aria-hidden="true" tabindex="-1"></a>ger_car_manufacturer_longer_sep_cyl<span class="sc">$</span>cylinders <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(ger_car_manufacturer_longer_sep_cyl<span class="sc">$</span>cylinders)</span></code></pre></div>
<p>Furthermore, you might want to sort your data in a different manner. If you want to do this by cylinders, it would look like this:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="workingwithdata.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(ger_car_manufacturer_longer_sep_cyl, cylinders)</span></code></pre></div>
<pre><code>## # A tibble: 40 × 3
##    manufacturer cylinders frequency
##    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;
##  1 Audi                 3        15
##  2 BMW                  3        14
##  3 Mercedes             3        19
##  4 Opel                 3        12
##  5 VW                   3        15
##  6 Audi                 4        62
##  7 BMW                  4        58
##  8 Mercedes             4        61
##  9 Opel                 4        80
## 10 VW                   4        58
## # … with 30 more rows</code></pre>
</div>
<div id="insertion-the-pipe" class="section level4" number="4.4.2.4">
<h4><span class="header-section-number">4.4.2.4</span> Insertion: the pipe</h4>
<p>Have you noticed the <code>%&gt;%</code>? That’s the pipe. It’s from the <code>magrittr</code> package <span class="citation">(<a href="#ref-bache2014" role="doc-biblioref">Bache and Wickham 2014</a>)</span> whose name is based on the Belgian painter who has created this masterpiece:</p>
<p><img src="figures/pipe1.png" /></p>
<p>Just kidding:</p>
<p><img src="figures/pipe2.jpg" /></p>
<p>It can be considered a conjunction in coding. Usually, you will use it when working with tibbles. What it does is pretty straight-forward: it takes what is on its left – the input – and provides it to the function on its right as the first argument. Hence, the code in the last chunk, which looks like this</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="workingwithdata.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(ger_car_manufacturer_longer_sep_cyl, cylinders)</span></code></pre></div>
<pre><code>## # A tibble: 40 × 3
##    manufacturer cylinders frequency
##    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;
##  1 Audi                 3        15
##  2 BMW                  3        14
##  3 Mercedes             3        19
##  4 Opel                 3        12
##  5 VW                   3        15
##  6 Audi                 4        62
##  7 BMW                  4        58
##  8 Mercedes             4        61
##  9 Opel                 4        80
## 10 VW                   4        58
## # … with 30 more rows</code></pre>
<p>could have also been written like this</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="workingwithdata.html#cb188-1" aria-hidden="true" tabindex="-1"></a>ger_car_manufacturer_longer_sep_cyl <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(cylinders)</span></code></pre></div>
<pre><code>## # A tibble: 40 × 3
##    manufacturer cylinders frequency
##    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;
##  1 Audi                 3        15
##  2 BMW                  3        14
##  3 Mercedes             3        19
##  4 Opel                 3        12
##  5 VW                   3        15
##  6 Audi                 4        62
##  7 BMW                  4        58
##  8 Mercedes             4        61
##  9 Opel                 4        80
## 10 VW                   4        58
## # … with 30 more rows</code></pre>
<p>because the tibble is the first argument in the function call.</p>
<p>Because <code>magrittr</code> really has gained traction in the R community, many functions are now optimized for being used with the pipe. However, there are still some around which are not. A function for fitting a basic linear model with one dependent and one independent variable which are both stored in a tibble looks like this: <code>lm(formula = dv ~ iv, data = tibble)</code>. Here, the tibble is not the first argument. To be able to fit a linear model in a “pipeline,” you need to employ a little hack: you can use a dot <code>.</code> as a placeholder.</p>
<p>Let’s check out the effect the number of cylinders has on the number of models:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="workingwithdata.html#cb190-1" aria-hidden="true" tabindex="-1"></a>ger_car_manufacturer_longer_sep_cyl <span class="sc">%&gt;%</span> </span>
<span id="cb190-2"><a href="workingwithdata.html#cb190-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(frequency <span class="sc">~</span> cylinders, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb190-3"><a href="workingwithdata.html#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = frequency ~ cylinders, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -28.283 -14.918   0.720   9.083  47.990 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  42.9203     6.3622   6.746 5.43e-08 ***
## cylinders    -2.7275     0.7058  -3.864 0.000421 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.54 on 38 degrees of freedom
## Multiple R-squared:  0.2821, Adjusted R-squared:  0.2632 
## F-statistic: 14.93 on 1 and 38 DF,  p-value: 0.0004214</code></pre>
<p>As <code>%&gt;%</code> is a bit tedious to type, there exist shortcuts: shift-ctrl-m on a Mac, shift-strg-m on a Windows machine.</p>
</div>
<div id="further-functionalities" class="section level4" number="4.4.2.5">
<h4><span class="header-section-number">4.4.2.5</span> Further functionalities</h4>
<div id="splitting-and-merging-cells" class="section level5" number="4.4.2.5.1">
<h5><span class="header-section-number">4.4.2.5.1</span> Splitting and merging cells</h5>
<p>If there are multiple values in one column/cell and you want to split them and put them into two rows instead of columns, <code>tidyr</code> offers you the <code>separate_rows()</code> function.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="workingwithdata.html#cb192-1" aria-hidden="true" tabindex="-1"></a>german_cars_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Audi =</span> <span class="st">&quot;A1, A3, A4, A5, A6, A7, A8&quot;</span>, <span class="at">BMW =</span> <span class="st">&quot;1 Series, 2 Series, 3 Series, 4 Series, 5 Series, 6 Series, 7 Series, 8 Series&quot;</span>)</span>
<span id="cb192-2"><a href="workingwithdata.html#cb192-2" aria-hidden="true" tabindex="-1"></a>german_cars_tbl <span class="ot">&lt;-</span> <span class="fu">enframe</span>(german_cars_vec, <span class="at">name =</span> <span class="st">&quot;brand&quot;</span>, <span class="at">value =</span> <span class="st">&quot;model&quot;</span>)</span>
<span id="cb192-3"><a href="workingwithdata.html#cb192-3" aria-hidden="true" tabindex="-1"></a>german_cars_tbl</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   brand model                                                                   
##   &lt;chr&gt; &lt;chr&gt;                                                                   
## 1 Audi  A1, A3, A4, A5, A6, A7, A8                                              
## 2 BMW   1 Series, 2 Series, 3 Series, 4 Series, 5 Series, 6 Series, 7 Series, 8…</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="workingwithdata.html#cb194-1" aria-hidden="true" tabindex="-1"></a>tidy_german_cars_tbl <span class="ot">&lt;-</span> german_cars_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb194-2"><a href="workingwithdata.html#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_rows</span>(model, <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<p><code>enframe()</code> enables you to create a tibble from a (named) vector. It outputs a tibble with two columns (<code>name</code> and <code>value</code> by default): <code>name</code> contains the names of the elements (if the elements are unnamed, it contains a serial number), <code>value</code> the element. Both can be renamed in the function call by providing a character vector.</p>
<p>If you want to achieve the opposite, i.e., merge cells’ content, you can use the counterpart, <code>unite()</code>. Let’s take the following dataframe which consists of the names of the professors of the Institute for Political Science:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="workingwithdata.html#cb195-1" aria-hidden="true" tabindex="-1"></a>professor_names_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">first_name =</span> <span class="fu">c</span>(<span class="st">&quot;Karlfriedrich&quot;</span>, <span class="st">&quot;Martin&quot;</span>, <span class="st">&quot;Jerzy&quot;</span>, <span class="st">&quot;Stephan&quot;</span>, <span class="st">&quot;Melanie&quot;</span>),</span>
<span id="cb195-2"><a href="workingwithdata.html#cb195-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">last_name =</span> <span class="fu">c</span>(<span class="st">&quot;Herb&quot;</span>, <span class="st">&quot;Sebaldt&quot;</span>, <span class="st">&quot;Maćków&quot;</span>, <span class="st">&quot;Bierling&quot;</span>, <span class="st">&quot;Walter-Rogg&quot;</span>))</span>
<span id="cb195-3"><a href="workingwithdata.html#cb195-3" aria-hidden="true" tabindex="-1"></a>professor_names_tbl <span class="ot">&lt;-</span> professor_names_df <span class="sc">%&gt;%</span> </span>
<span id="cb195-4"><a href="workingwithdata.html#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb195-5"><a href="workingwithdata.html#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(first_name, last_name, <span class="at">col =</span> <span class="st">&quot;name&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>, <span class="at">na.rm =</span> <span class="cn">FALSE</span>)</span>
<span id="cb195-6"><a href="workingwithdata.html#cb195-6" aria-hidden="true" tabindex="-1"></a>professor_names_tbl</span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##   name               
##   &lt;chr&gt;              
## 1 Karlfriedrich Herb 
## 2 Martin Sebaldt     
## 3 Jerzy Maćków       
## 4 Stephan Bierling   
## 5 Melanie Walter-Rogg</code></pre>
<p><code>unite()</code> takes the tibble it should be applied to as the first argument (not necessary if you use the pipe). Then, it takes the two or more columns as arguments (actually, this is not necessary if you want to unite all columns). <code>col =</code> takes a character vector to specify the name of the resulting, new column. <code>remove = TRUE</code> indicates that the columns that are united are removed as well. You can, of course, set it to false, too. <code>na.rm = FALSE</code> finally indicates that missing values are not to be removed prior to the uniting process.</p>
<p>Here, the final variant of creating tibbles is introduced as well: you can apply the function <code>as_tibble()</code> to a data frame and it will then be transformed into a tibble.</p>
</div>
</div>
</div>
</div>
<div id="further-links-3" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Further links</h2>
<ul>
<li>Hadley on <a href="https://vita.had.co.nz/papers/tidy-data.pdf">tidy data</a><br />
</li>
<li>The two <code>pivot_*()</code> functions lie at the heart of <code>tidyr</code>. <a href="https://www.storybench.org/pivoting-data-from-columns-to-rows-and-back-in-the-tidyverse/">This article</a> from the Northeastern University’s School of Journalism explains it in further detail.</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bache2014" class="csl-entry">
Bache, Stephan Milton, and Hadley Wickham. 2014. <span>“Magrittr: <span>A Forward</span>-<span>Pipe Operator</span> for <span>R</span>.”</span>
</div>
<div id="ref-hester2018" class="csl-entry">
Hester, Jim, Hadley Wickham, Romain François, Jukka Jylänki, and Mikkel Jørgensen. 2018. <span>“Readr: <span>Read Rectangular Text Data</span>.”</span>
</div>
<div id="ref-hester2020" class="csl-entry">
Hester, Jim, Hadley Wickham, Jukka Jylänki, and Mikkel Jørgensen. 2020. <span>“Vroom: <span>Read</span> and <span>Write Rectangular Text Data Quickly</span>.”</span>
</div>
<div id="ref-muller2020" class="csl-entry">
Müller, Kirill, Hadley Wickham, and Romain François. 2020. <span>“Tibble: <span>Simple Data Frames</span>.”</span>
</div>
<div id="ref-wickham2014" class="csl-entry">
———. 2014. <span>“Tidy <span>Data</span>.”</span> <em>Journal of Statistical Software</em> 59 (10). <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
<div id="ref-wickham2020b" class="csl-entry">
———. 2020b. <span>“Tidyr: <span>Tidy Messy Data</span>.”</span>
</div>
<div id="ref-wickham2019e" class="csl-entry">
Wickham, Hadley, Jennifer Bryan, Komarov Valery, Christophe Leitienne, Bob Colbert, David Hoerl, and Evan Miller. 2019. <span>“Readxl: <span>Read Excel Files</span>.”</span>
</div>
<div id="ref-wickham2016a" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. First edition. <span>Sebastopol, CA</span>: <span>O’Reilly</span>.
</div>
<div id="ref-wickham2020c" class="csl-entry">
Wickham, Hadley, and Evan Miller. 2020. <span>“Haven: <span>Import</span> and <span>Export</span> ’<span>SPSS</span>’, ’<span>Stata</span>’ and ’<span>SAS</span>’ <span>Files</span>.”</span>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>you can find the thoughts of the of the main author of the <code>knitr</code> package on working directories <a href="https://groups.google.com/forum/#!topic/knitr/knM0VWoexT0">here</a><a href="workingwithdata.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>which can be found <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">here</a> or using <code>vignette("tidy-data", package = "tidyr")</code><a href="workingwithdata.html#fnref6" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intror.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrangling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["introduction-to-r.pdf", "introduction-to-r.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
